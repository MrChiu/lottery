{% extends "layout/default.html" %}


{% block main_content %}

	<h3 class="header smaller lighter blue">知行合一</h3>

	<div class="clearfix">
		<div class="pull-right tableTools-container"></div>
	</div>

	<div class="col-xs-12 col-sm-2">
		<div class="easy-pie-chart percentage" data-percent="{{percent1}}" data-color="#89b95b" 
				style="margin-left: 35px; margin-bottom: 15px;" >
			<span class="percent">{{percent1}}</span>%
		</div>
		<div style="margin-left: 30px; width: 104px; height: 95px;" >
			<a id="data_sync" href="#" class="btn btn-app btn-success">
				<i class="fa fa-download bigger-230"></i>
				<br/>
				数据同步
			</a>
		</div>
	</div>
	<div class="col-xs-12 col-sm-3">
		<div class="widget-box">
			<div class="widget-header header-color-blue">
				<h5 class="bigger lighter">
					 PRICE_1D数据同步检视
				</h5>
			</div>
			<div class="widget-body" style="overflow: auto;height: 244px;">
				<div class="widget-main no-padding">
					<table class="table table-striped table-bordered table-hover">
						<thead class="thin-border-bottom">
							<tr>
								<th>代码</th>
								<th>最后同步时间</th>
							</tr>
						</thead>
						<tbody>
							{% for index,element in enumerate(price_1d_s) %}
								<tr>
									<td>{{element['CODE']}}</td>
									<td>{{element['DATE']}}</td>
								</tr>
							{% end %}
						</tbody>
					</table>
				</div>
			</div>
		</div>
	</div>
	<div class="col-xs-12 col-sm-3">
		<div class="widget-box">
			<div class="widget-header header-color-blue">
				<h5 class="bigger lighter">
					 PRICE_60M数据同步检视
				</h5>
			</div>
			<div class="widget-body" style="overflow: auto;height: 244px;">
				<div class="widget-main no-padding">
					<table class="table table-striped table-bordered table-hover">
						<thead class="thin-border-bottom">
							<tr>
								<th>代码</th>
								<th>最后同步时间</th>
							</tr>
						</thead>
						<tbody>
							{% for index,element in enumerate(price_60m_s) %}
								<tr>
									<td>{{element['CODE']}}</td>
									<td>{{element['DATE']}}</td>
								</tr>
							{% end %}
						</tbody>
					</table>
				</div>
			</div>
		</div>
	</div>
	

<script type="text/javascript">
	jQuery(function($) {
		$("#data_sync").click(function(){
			dataSync()
		})
	})

	function dataSync(){
		$.ajax({
			url: "/dashboard/datasync",
			type: "GET", 
			contentType: 'application/json',
			success: function (data) {
				alert("数据同步成功!")
				window.location.reload();
			}
		});
	}

	var oldie = /msie\s*(8|7|6)/.test(navigator.userAgent.toLowerCase());
	$('.easy-pie-chart.percentage').each(function(){
		$(this).easyPieChart({
			barColor: $(this).data('color'),
			trackColor: '#EEEEEE',
			scaleColor: false,
			lineCap: 'butt',
			lineWidth: 8,
			animate: oldie ? false : 1000,
			size:95
		}).css('color', $(this).data('color'));
	});
</script>

{% end %}